#https://zenn.dev/nikaera/articles/unity-gameci-github-actions

name: aluãƒ•ã‚¡ã‚¤ãƒ«ã®å…¥æ‰‹
on:
    workflow_dispatch: {}
jobs:
    get_version:
        name: Unityãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’å–å¾—ã—ã¦ã„ã¾ã™
        runs-on: ubuntu-latest
            outputs:
            output1: ${{ steps.step1.outputs.version }}
        steps:
            - name: Checkout code
              uses: actions/checkout@v2

            - name: Setup Python
              uses: actions/setup-python@v2
              with:
                  python-version: "3.x"

            - name: Get version number
              id: get_version
              run: |
                  echo "Extracting version number"
                  version=$(python .github/workflows/get_version.py ProjectSettings/ProjectVersion.txt)
                  echo "::set-output name=version::$version"
    activation:
        name: Request manual activation file ğŸ”‘
        runs-on: ubuntu-latest
        steps:
            # GameCI ã® Activation ã‚’åˆ©ç”¨ã—ã¦ alf ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç™ºè¡Œã™ã‚‹
            - name: Request manual activation file
              id: getManualLicenseFile
              uses: game-ci/unity-request-activation-file@v2
              with:
                  # Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹
                  # ProjectSettings/ProjectVersion.txt ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã™ã‚Œã° OK
                  #unityVersion: 2021.3.19f1
                  unityVersion: ${{needs.get_version.outputs.version}}
            # Upload artifact (Unity_v20XX.X.XXXX.alf)
            - name: Expose as artifact
              uses: actions/upload-artifact@v2
              with:
                  name: ${{ steps.getManualLicenseFile.outputs.filePath }}
                  path: ${{ steps.getManualLicenseFile.outputs.filePath }}
